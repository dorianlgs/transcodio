<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transcodio</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="16" cy="16" r="14" stroke="url(#gradient)" stroke-width="2"/>
                    <path d="M12 10 L12 22 L20 16 Z" fill="url(#gradient)"/>
                    <defs>
                        <linearGradient id="gradient" x1="0" y1="0" x2="32" y2="32">
                            <stop offset="0%" stop-color="#667eea"/>
                            <stop offset="100%" stop-color="#764ba2"/>
                        </linearGradient>
                    </defs>
                </svg>
                <h1>Transcodio</h1>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Mode Selector -->
            <div class="mode-selector">
                <button class="mode-btn active" data-mode="transcription" id="transcriptionModeBtn">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M10 2C5.58 2 2 5.58 2 10C2 14.42 5.58 18 10 18C14.42 18 18 14.42 18 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        <path d="M10 6V14M6 10H14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    Transcribir
                </button>
                <button class="mode-btn" data-mode="voice-clone" id="voiceCloneModeBtn">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M10 2V18M6 4V16M14 4V16M2 7V13M18 7V13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    Clonar Voz
                </button>
            </div>

            <!-- Upload Section -->
            <section class="upload-section" id="uploadSection">
                <div class="upload-area" id="uploadArea">
                    <svg class="upload-icon" width="64" height="64" viewBox="0 0 64 64" fill="none">
                        <circle cx="32" cy="32" r="30" stroke="currentColor" stroke-width="2" opacity="0.3"/>
                        <path d="M32 20 L32 44 M20 32 L44 32" stroke="currentColor" stroke-width="3" stroke-linecap="round"/>
                    </svg>
                    <h2>Arrastra tu archivo de audio aquí</h2>
                    <p>o haz clic para seleccionar</p>
                    <p class="file-info">Soporta MP3, WAV, M4A, FLAC, OGG • Máx 100MB • Hasta 60 minutos</p>
                    <input type="file" id="fileInput" accept="audio/*" hidden>
                </div>
                <div class="upload-options">
                    <label class="checkbox-label">
                        <input type="checkbox" id="enableDiarization">
                        <span class="checkbox-custom"></span>
                        <span class="checkbox-text">Identificar hablantes</span>
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="enableMinutes">
                        <span class="checkbox-custom"></span>
                        <span class="checkbox-text">Generar minuta de reunión</span>
                    </label>
                </div>
            </section>

            <!-- Processing Section -->
            <section class="processing-section hidden" id="processingSection">
                <div class="processing-card">
                    <div class="spinner"></div>
                    <h3>Transcribiendo tu audio...</h3>
                    <p class="processing-status" id="processingStatus">Subiendo archivo...</p>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                </div>
            </section>

            <!-- Results Section -->
            <section class="results-section hidden" id="resultsSection">
                <div class="results-header">
                    <h2>Resultados de Transcripción</h2>
                    <div class="results-actions">
                        <button class="btn btn-secondary" id="downloadBtn">
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                                <path d="M9 3 L9 12 M5 9 L9 13 L13 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                <path d="M3 15 L15 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            TXT
                        </button>
                        <button class="btn btn-secondary" id="downloadSrtBtn">
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                                <path d="M9 3 L9 12 M5 9 L9 13 L13 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                <path d="M3 15 L15 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            SRT
                        </button>
                        <button class="btn btn-secondary" id="downloadVttBtn">
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                                <path d="M9 3 L9 12 M5 9 L9 13 L13 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                <path d="M3 15 L15 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            VTT
                        </button>
                        <button class="btn btn-primary" id="newTranscriptionBtn">Nueva Transcripción</button>
                    </div>
                </div>

                <div class="metadata" id="metadata">
                    <span class="metadata-item">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5"/>
                            <path d="M8 8 L8 5 M8 8 L10 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                        <span id="duration">--</span>
                    </span>
                    <span class="metadata-item">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                            <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5"/>
                            <text x="8" y="11" text-anchor="middle" fill="currentColor" font-size="8">A</text>
                        </svg>
                        <span id="language">--</span>
                    </span>
                </div>

                <div class="audio-player-container">
                    <audio id="audioPlayer" controls></audio>
                </div>

                <!-- Tabs -->
                <div class="tabs-container">
                    <div class="tabs-header">
                        <button class="tab-btn active" data-tab="transcription">Transcripción</button>
                        <button class="tab-btn" data-tab="minutes" id="minutesTabBtn">Minuta</button>
                    </div>

                    <!-- Transcription Tab -->
                    <div class="tab-content active" id="transcriptionTab">
                        <div class="transcription-content">
                            <div class="segments" id="segments"></div>
                        </div>
                    </div>

                    <!-- Minutes Tab -->
                    <div class="tab-content" id="minutesTab">
                        <div class="minutes-section" id="minutesSection">
                    <div class="minutes-header">
                        <h3>Minuta de Reunión</h3>
                        <button class="btn btn-secondary" id="downloadMinutesBtn">
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                                <path d="M9 3 L9 12 M5 9 L9 13 L13 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                <path d="M3 15 L15 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            Descargar Minuta
                        </button>
                    </div>
                    <div class="minutes-loading hidden" id="minutesLoading">
                        <div class="spinner-small"></div>
                        <span>Generando minuta de reunión...</span>
                    </div>
                    <div class="minutes-content" id="minutesContent">
                        <div class="minutes-block">
                            <h4>Resumen Ejecutivo</h4>
                            <p id="minutesSummary"></p>
                        </div>
                        <div class="minutes-block">
                            <h4>Puntos Clave Discutidos</h4>
                            <ul id="minutesKeyPoints"></ul>
                        </div>
                        <div class="minutes-block">
                            <h4>Decisiones Tomadas</h4>
                            <ul id="minutesDecisions"></ul>
                        </div>
                        <div class="minutes-block">
                            <h4>Acciones Pendientes</h4>
                            <ul id="minutesActions" class="action-items-list"></ul>
                        </div>
                        <div class="minutes-block">
                            <h4>Participantes Mencionados</h4>
                            <div id="minutesParticipants" class="participants-tags"></div>
                        </div>
                    </div>
                </div>
                    </div>
                </div>
            </section>

            <!-- Voice Clone Section -->
            <section class="voice-clone-section hidden" id="voiceCloneSection">
                <div class="voice-clone-card">
                    <h2>Clonar Voz</h2>
                    <p class="voice-clone-subtitle">Sube un audio de referencia y genera nuevos textos con la misma voz</p>

                    <!-- Reference Audio -->
                    <div class="voice-clone-form-group">
                        <label class="form-label">Audio de Referencia (3-30 segundos)</label>
                        <div class="ref-audio-tabs">
                            <button class="ref-audio-tab active" data-tab="upload" id="refUploadTab">Subir Archivo</button>
                            <button class="ref-audio-tab" data-tab="record" id="refRecordTab">Grabar</button>
                        </div>

                        <!-- Upload Tab -->
                        <div class="ref-audio-content active" id="refUploadContent">
                            <div class="ref-upload-area" id="refUploadArea">
                                <svg width="40" height="40" viewBox="0 0 40 40" fill="none">
                                    <path d="M20 8V32M8 20H32" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                                <span>Arrastra o haz clic para subir</span>
                                <input type="file" id="refFileInput" accept="audio/*" hidden>
                            </div>
                            <div class="ref-audio-preview hidden" id="refAudioPreview">
                                <audio id="refAudioPlayer" controls></audio>
                                <button class="btn-icon" id="removeRefAudio" title="Eliminar">
                                    <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                                        <path d="M4 4L14 14M4 14L14 4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <!-- Record Tab -->
                        <div class="ref-audio-content" id="refRecordContent">
                            <div class="record-controls">
                                <button class="record-btn" id="recordBtn">
                                    <span class="record-icon"></span>
                                </button>
                                <div class="record-timer" id="recordTimer">00:00 / 00:30</div>
                                <div class="record-progress">
                                    <div class="record-progress-bar" id="recordProgressBar"></div>
                                </div>
                            </div>
                            <div class="recorded-preview hidden" id="recordedPreview">
                                <audio id="recordedAudioPlayer" controls></audio>
                                <button class="btn-icon" id="removeRecordedAudio" title="Eliminar">
                                    <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                                        <path d="M4 4L14 14M4 14L14 4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Reference Text -->
                    <div class="voice-clone-form-group">
                        <label class="form-label" for="refTextInput">Transcripcion del Audio de Referencia</label>
                        <textarea id="refTextInput" class="form-textarea" placeholder="Escribe exactamente lo que dice el audio de referencia..." rows="3"></textarea>
                    </div>

                    <!-- Target Text -->
                    <div class="voice-clone-form-group">
                        <label class="form-label" for="targetTextInput">Texto a Sintetizar (max. 500 caracteres)</label>
                        <textarea id="targetTextInput" class="form-textarea" placeholder="Escribe el texto que quieres generar con la voz clonada..." rows="4" maxlength="500"></textarea>
                        <div class="char-counter"><span id="charCount">0</span> / 500</div>
                    </div>

                    <!-- Model Selector -->
                    <div class="voice-clone-form-group">
                        <label class="form-label" for="ttsModelSelect">Modelo TTS</label>
                        <select id="ttsModelSelect" class="form-select">
                            <option value="qwen" selected>Qwen3-TTS (Rapido, 1.7B)</option>
                            <option value="higgs">Higgs Audio V2 (Alta calidad, 3B)</option>
                        </select>
                        <p class="form-hint" id="modelHint">Rapido y buena calidad para la mayoria de casos</p>
                    </div>

                    <!-- Language Selector -->
                    <div class="voice-clone-form-group">
                        <label class="form-label" for="languageSelect">Idioma</label>
                        <select id="languageSelect" class="form-select">
                            <option value="Spanish" selected>Espanol</option>
                            <option value="English">Ingles</option>
                            <option value="Chinese">Chino</option>
                            <option value="Japanese">Japones</option>
                            <option value="Korean">Coreano</option>
                            <option value="German">Aleman</option>
                            <option value="French">Frances</option>
                            <option value="Russian">Ruso</option>
                            <option value="Portuguese">Portugues</option>
                            <option value="Italian">Italiano</option>
                        </select>
                    </div>

                    <!-- Generate Button -->
                    <button class="btn btn-primary btn-generate" id="generateVoiceBtn">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                            <path d="M10 2V18M6 4V16M14 4V16M2 7V13M18 7V13" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                        </svg>
                        Generar Voz
                    </button>
                </div>
            </section>

            <!-- Voice Clone Processing Section -->
            <section class="voice-clone-processing hidden" id="voiceCloneProcessing">
                <div class="processing-card">
                    <div class="spinner"></div>
                    <h3>Generando voz clonada...</h3>
                    <p class="processing-status">Esto puede tardar unos segundos</p>
                </div>
            </section>

            <!-- Voice Clone Results Section -->
            <section class="voice-clone-results hidden" id="voiceCloneResults">
                <div class="results-header">
                    <h2>Voz Generada</h2>
                    <div class="results-actions">
                        <button class="btn btn-secondary" id="downloadVoiceBtn">
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                                <path d="M9 3 L9 12 M5 9 L9 13 L13 9" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                                <path d="M3 15 L15 15" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            Descargar WAV
                        </button>
                        <button class="btn btn-primary" id="newVoiceCloneBtn">Nueva Clonacion</button>
                    </div>
                </div>

                <div class="voice-result-card">
                    <div class="audio-player-container">
                        <audio id="generatedAudioPlayer" controls></audio>
                    </div>
                    <div class="voice-result-info">
                        <span class="metadata-item">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5"/>
                                <path d="M8 8 L8 5 M8 8 L10 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                            <span id="generatedDuration">--</span>
                        </span>
                    </div>
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>Desarrollado por <a href="https://cifu.dev" target="_blank" rel="noopener noreferrer">cifu.dev</a></p>
        </footer>
    </div>

    <!-- Toast Notification -->
    <div class="toast hidden" id="toast"></div>

    <script src="/static/app.js"></script>
</body>
</html>
